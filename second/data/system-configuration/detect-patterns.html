<!--9.3系统配置-侦测模式-->
<div id="detect-patterns" class="page-content-wrapper detect">
    <div class="page-content portlet-wrapper">
        <!--第一行 页签-->
        <div class="portlet tab-border">
            <div class="portlet-title">
                <ul class="nav nav-tabs ">
                    <li class="active">
                        <a>侦测模式</a>
                        <span class="selected"></span>
                    </li>
                </ul>
            </div>
        </div>
        <!--侦测模式首页-->
        <div class="tab-content active">
            <div class="portlet">
                    <div class="portlet-body portlet-body-default">
                        <p>选择一个设备监控模式：<span>（改变模式需要重启设备）</span></p>
                        <div class="detect-row">
                            <label>
                                <input type="radio" name="model" checked> 旁路监听模式: 离线部署模式，监测并报告病毒。
                            </label>
                            <label>
                                <input type="radio" name="model"> 透明/反向代理模式: 在线部署模式，允许Anchiva WAF主动阻止病毒。
                            </label>
                        </div>
                        <div class="detect-row">
                            <label>
                                <input type="checkbox"> 透明模式
                            </label>
                            <label>
                                <input type="checkbox"> 反向代理模式
                            </label>
                            <button class="btn-normal">配置</button>
                        </div>
                    </div>
                    <div class="button-group">
                        <button>应用</button>
                        <button>取消</button>
                    </div>
            </div>
        </div>
        <!--侦测模式详情页-->
        <div class="tab-content patterns-details" id="detect-patterns-details">
            <div class="portlet-body portlet-body-default">
                <div class="table-row">
                    <div class="portlet-title">
                        <p class="p-title">
                            <i></i>
                            <span>反向代理接口</span>
                            <select>
                                <option value="0"></option>
                            </select>
                            <button class="btn-normal">应用</button>
                        </p>
                        <ul class="bt-bars pull-left">
                            <li class="active"><a href="javascript:;"><img src="imgs/8.png"/>添加</a></li>
                            <li><a href="javascript:;"><img src="imgs/delete.png"/>删除</a></li>
                        </ul>
                        <ul class="table-footer pull-right"></ul>
                    </div>
                    <table class="portlet-table active" id="reverseInterface">
                        <thead>
                        <tr>
                            <td><input type="checkbox" onclick="selectAll(this)"/></td>
                            <td>代理IP地址／子网掩码：端口</td>
                            <td>主机名</td>
                            <td>服务器 IP地址：端口</td>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div class="table-row">
                    <div class="portlet-title">
                        <p class="p-title">
                            <i></i>
                            <span>服务器负载均衡</span>
                        </p>
                        <ul class="bt-bars">
                            <li class="active"><a href="javascript:;"><img src="imgs/8.png"/>添加</a></li>
                            <li><a href="javascript:;"><img src="imgs/delete.png"/>删除</a></li>
                        </ul>
                    </div>
                    <div class="tContainer-patterns">
                        <table class="portlet-table active" id="loadBalancing">
                            <thead>
                            <tr>
                                <td><input type="checkbox" onclick="selectAll(this)"/></td>
                                <td>服务器组</td>
                                <td>代理IP地址/子网掩码:端口</td>
                                <td>负载均衡算法</td>
                                <td>主机名</td>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="portlet-title">
                        <p class="p-title">
                            <i></i>
                            <span>服务器组</span>
                        </p>
                        <ul class="bt-bars">
                            <li class="active"><a href="javascript:;"><img src="imgs/8.png"/>添加</a></li>
                            <li><a href="javascript:;"><img src="imgs/delete.png"/>删除</a></li>
                        </ul>
                    </div>
                    <div class="tContainer-patterns">
                        <table class="portlet-table active" id="serverGroup">
                            <thead>
                            <tr>
                                <td><input type="checkbox" onclick="selectAll(this)"/></td>
                                <td>服务器组</td>
                                <td>服务器IP地址:端口</td>
                                <td>备注</td>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!--反向代理接口配置页-->
        <div class="tab-content patterns-details detect-add" id="reverse-proxy-add">
            <div class="portlet-body portlet-body-default">
                <p class="p-title">
                    <i></i>
                    <span>反向代理配置</span>
                </p>
                <div class="system-configuration-row">
                    <div class="form-group">
                        <label>代理IP地址/子掩网码</label>
                        <input class="input-add"/>
                    </div>
                    <div class="form-group">
                        <label>代理监听端口</label>
                        <input class="input-add"/>
                        <span>(1-65535)</span>
                    </div>
                    <div class="form-group">
                        <label>主机名</label>
                        <input class="input-add"/>
                    </div>
                    <div class="form-group form-inline">
                        <label>服务器IP地址</label>
                        <input class="input-add"/>
                        <label>端口</label>
                        <input class="input-add"/>
                    </div>
                </div>
            </div>
            <div class="button-group">
                <button>应用</button>
                <button>取消</button>
            </div>
        </div>
        <!--服务器组负载均衡配置页-->
        <div class="tab-content patterns-details detect-add" id="loading-balance-add">
            <div class="portlet-body portlet-body-default">
                <p class="p-title">
                    <i></i>
                    <span>负载均衡配置</span>
                </p>
                <div class="system-configuration-row">
                    <div class="form-group">
                        <label>服务器组</label>
                        <select id="server-group-select" class="select-add">
                        </select>
                    </div>
                    <div class="form-group">
                        <label>代理 IP 地址／子网掩码：端口</label>
                        <input class="input-add"/>：<input class="input-add"/>
                    </div>
                    <div class="form-group">
                        <label>负载均衡算法</label>
                        <select id="algorithm" class="select-add">
                            <option value="0">IP哈希</option>
                            <option value="1">最少连接数</option>
                            <option value="2">轮询</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>主机名</label>
                        <input class="input-add"/>
                    </div>
                </div>
            </div>
            <div class="button-group">
                <button>应用</button>
                <button>取消</button>
            </div>
        </div>
        <!--服务器组配置页-->
        <div class="tab-content patterns-details detect-add" id="server-group-add">
            <div class="portlet-body portlet-body-default">
                <p class="p-title">
                    <i></i>
                    <span>服务器组配置</span>
                </p>
                <div class="system-configuration-row">
                    <div class="form-group">
                        <label>服务器组名称</label>
                        <input class="input-add"/>
                    </div>
                    <div class="form-group">
                        <label>服务器IP端口</label>
                        <input class="input-add"/>：<input class="input-add"/>
                    </div>
                    <div class="form-group">
                        <label>备注</label>
                        <input class="input-add"/>
                        <img src="imgs/ad.png" class="add-img"/>
                        <span>添加至列表</span>
                    </div>
                </div>
                <div class="system-configuration-row">
                    <ul class="bt-bars">
                        <li><a href="javascript:;"><img src="imgs/delete.png"/>删除</a></li>
                    </ul>
                    <table class="portlet-table active portlet-body-default" id="serverGroupAdd">
                        <thead>
                        <tr>
                            <td><input type="checkbox" onclick="selectAll(this)"/></td>
                            <td>服务器</td>
                            <td>端口</td>
                            <td>备注</td>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="button-group">
                <button>应用</button>
                <button>取消</button>
            </div>
        </div>
        <!--提示框-->
        <div class="tip-container">
            <!--删除提示框-->
            <div class="tip">
                <button type="button" class="close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <img/>
                <p></p>
                <div class="tip-footer">
                    <button type="button" class="btn">确定</button>
                    <button type="button" class="btn">取消</button>
                </div>
            </div>
            <!--警告框-->
            <div class="tip1">
                <button type="button" class="close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <img/>
                <p></p>
                <div class="tip-footer">
                    <button type="button" class="btn">知道了</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var tipC = $(".tip-container"),//提示框背景
        tip = $(".tip"),//确认删除提示框
        tip1 = $(".tip1"),//警告提示框
        tipAll=$(".tip, .tip1"),//提示框组
        tipP = $(".tip-container p"),//提示文字
        length;//服务器组数据长度

    position();//提示框定位

    //关闭提示框
    $(".tip-container .close,.tip-footer button").click(function () {
        tipC.hide();
    });

    //侦测模式配置详情
    $("#detect-patterns .btn-normal").click(function(){
        $("#detect-patterns-details").addClass("active").siblings("div").removeClass("active");
        addData("reverseInterface");
        addData("loadBalancing");
        addData("serverGroup");
        var chbs=$("#detect-patterns-details tbody [name='checkIP']");
        $.each(chbs,function(i,n){
            n.onclick=selectOne;
        });
    });

    //添加按钮
    $(".bt-bars li:first-child").click(function(){
        if($(this).parents(".portlet-title").siblings()[0]===$("#reverseInterface")[0]){//反向代理接口配置页
            $("#reverse-proxy-add").addClass("active").siblings("div").removeClass("active")
        }else if($(this).parents(".portlet-title").next().has("#loadBalancing")[0]===$("#loadBalancing").parent()[0]){//服务器负载均衡配置页
            $("#loading-balance-add").addClass("active").siblings("div").removeClass("active");
            //载入服务器组数据
            var str="";
            $.each(serverGroup,function(i,n){
                str+='<option value="'+i+'">'+n.service.name+'</option>';
            });
            $("#server-group-select").html(str);
        }else if($(this).parents(".portlet-title").next().has("#serverGroup")[0]===$("#serverGroup").parent()[0]){//服务器组配置页
            $("#server-group-add").addClass("active").siblings("div").removeClass("active");
            length=serverGroup.length;//服务器组数量
        }
    });

    //删除按钮
    $(".bt-bars li:nth-child(2)").click(function(){
        var chbs,//选项组
            selAll,//全选框
            tipMark=true,//提示框显示标记
            mark=true;//服务器组可以被删除标志
        if($(this).parents(".portlet-title").siblings()[0]===$("#reverseInterface")[0]){//反向代理接口
            chbs=$("#reverseInterface [name='checkIP']");
            selAll=$("#reverseInterface thead input[type=checkbox]");
            if(selAll[0].checked===true){//全选的情况下
                reverseInterface.record_count-=reverseInterface.data.length;
                reverseInterface.data=[];//当前页的数据
                selAll[0].checked=false;
            }else{                       //未全选的情况下
                $.each(chbs,function(i,n){
                    var me=$(this);
                    if(n.checked==true){
                        $.each(reverseInterface.data,function(k,m){
                            if(m.agentIP===me.parent().siblings()[0].innerHTML){
                                for(var j=k;j<reverseInterface.data.length-1;j++){
                                    reverseInterface.data[j]=reverseInterface.data[j+1];
                                    reverseInterface.data[j].id--;
                                }
                            }
                        });
                        reverseInterface.record_count--;
                        reverseInterface.data.pop();
                    }
                });
            }
            addData("reverseInterface");//重新载入表格
        }else if($(this).parents(".portlet-title").next().has("#loadBalancing")[0]===$("#loadBalancing").parent()[0]){//服务器负载均衡
            chbs=$("#loadBalancing [name='checkIP']");
            selAll=$("#loadBalancing thead input[type=checkbox]");
            if(selAll[0].checked===true){
                loadBalancing=[];
                selAll[0].checked=false;
            }else{
                $.each(chbs,function(i,n){
                    var me=$(this);
                    if(n.checked==true){
                        $.each(loadBalancing,function(k,m){
                            if(m.service===me.parent().siblings()[0].innerHTML && m.agentIP===me.parent().siblings()[1].innerHTML){
                                for(var j=k;j<loadBalancing.length-1;j++){
                                    loadBalancing[j]=loadBalancing[j+1];
                                    loadBalancing[j].id--;
                                }
                            }
                        });
                        loadBalancing.pop();
                    }
                });
            }
            addData("loadBalancing");//重新载入表格
        }else if($(this).parents(".portlet-title").next().has("#serverGroup")[0]===$("#serverGroup").parent()[0]){//服务器组
            chbs=$("#serverGroup [name='checkIP']");
            selAll=$("#serverGroup thead input[type=checkbox]");
            if(selAll[0].checked===true){
                $.each(loadBalancing,function(p,q){
                    $.each(serverGroup,function(k,m){
                        (m.service.name === q.service) && (mark=false);//服务器在引用的情况下不允许被删除
                    })
                });
                if(mark){
                    serverGroup=[];
                }else{
                    tipWarning(tipC, tip1, tipP, "存在正使用的服务器组，禁止删除！");
                }
                selAll[0].checked=false;
            }else{
                $.each(chbs,function(i,n){
                    var me=$(this);
                    if(n.checked==true){
                        $.each(loadBalancing,function(p,q){
                            if(q.service===me.parent().siblings()[0].innerHTML){
                                mark=false;
                            }
                        });
                        if(mark){
                            //所删除的服务器组没有被使用，就可以删除
                            $.each(serverGroup,function(k,m){
                                if(m.service.name===me.parent().siblings()[0].innerHTML){
                                    for(var j=k;j<serverGroup.length-1;j++){
                                        serverGroup[j]=serverGroup[j+1];
                                        serverGroup[j].id--;
                                    }
                                }
                            });
                            serverGroup.pop();
                        }else{
                            tipWarning(tipC, tip1, tipP, "存在正使用的服务器组，禁止删除！");
                        }
                    }
                });
            }
            addData("serverGroup");
        }
        //没有选择任何选项就点删除时，给出提示
        if(selAll[0].checked===false){
            $.each(chbs,function(i,n){
                if(n.checked==true){
                    tipMark=false;
                }
            });
            tipMark && tipWarning(tipC, tip1, tipP, "请选择要删除的选项！");
        }
    });

    //添加页面的取消键
    $(".detect-add button:nth-child(2)").click(function(){
        var id=$(this).parents(".detect-add")[0].id,//当前添加页的id
            input=$("#"+id+" .input-add"),//当前页内的输入框
            select=$("#"+id+" .select-add");//当前页内的下拉框

        //取消之后清空下拉框
        $.each(input,function(i,n){
            n.value="";
        });

        if(id==="loading-balance-add"){//服务器负载均衡配置页
            select[1].value=0;//取消之后还原下拉框
        }else if(id==="server-group-add"){
            //清空预添加数据
            serverGroupAdd=[];
            input[0].removeAttribute("disabled");
            $("#serverGroupAdd tbody").empty();
        }

        $("#detect-patterns-details").addClass("active").siblings("div").removeClass("active");//返回详情页
    });

    //反向代理配置应用键
    $("#reverse-proxy-add .button-group button:first-child").click(function(){
        var input=$("#"+$(this).parents(".detect-add ")[0].id+" input"),
            inputArr=[],
            mark=true;//是否添加数据的标识
        //判断信息是否都填全
        $.each(input,function(i,n){
            if(n.value===""){
                inputArr.push(n);
            }
        });
        if(inputArr.length!=0){     //没有填全就弹出警告框
            tipWarning(tipC, tip1, tipP, "请先全部填写要处理的数据信息！");
            mark=false;
        }else{      //填全了就判断是否存在于原始数据中
            $.each(reverseInterface.data,function(i,n){
                if(n.agentIP===input[0].value+":"+input[1].value && n.name===input[2].value && n.serviceIP===input[3].value+":"+input[4].value){
                    tipWarning(tipC, tip1, tipP, "所添加数据在原始数据表中重复！");
                    mark=false;
                }
            });
        }
        if(mark){       //不存在于原始数据，就添加数据
            var id=reverseInterface.data.length,data;
            data={
                id:id,
                agentIP:input[0].value+":"+input[1].value,
                name:input[2].value,
                serviceIP:input[3].value+":"+input[4].value
            };
            reverseInterface.record_count++;
            reverseInterface.data.push(data);
            $.each(input,function(i,n){
                n.value="";
            });
            $("#detect-patterns-details").addClass("active").siblings("div").removeClass("active");
            addData("reverseInterface");
        }
    });

    //服务器负载均衡配置应用键
    $("#loading-balance-add .button-group button:first-child").click(function(){
        var input=$("#"+$(this).parents(".detect-add ")[0].id+" input"),
             inputArr=[],
             select=$("#"+$(this).parents(".detect-add ")[0].id+" select"),
             mark=true;
        $.each(input,function(i,n){
            if(n.value===""){
                inputArr.push(n);
            }
        });
        if(inputArr.length!=0){
            tipWarning(tipC, tip1, tipP, "请先全部填写要处理的数据信息！");
            mark=false;
        }else{
            $.each(loadBalancing,function(i,n){
               if(n.service===$("#server-group-select").find("option:selected").text() && n.agentIP===input[0].value+":"+input[1].value && n.algorithm===$("#algorithm").find("option:selected").text() && n.name===input[2].value){
                   tipWarning(tipC, tip1, tipP, "所添加数据在原始数据表中重复！");
                   mark=false;
               }
            });
        }
        if(mark){
            var id=loadBalancing.length,data;
            data={
                id:id,
                service:$("#server-group-select").find("option:selected").text(),
                agentIP:input[0].value+":"+input[1].value,
                algorithm:$("#algorithm").find("option:selected").text(),
                name:input[2].value
            };
            loadBalancing.record_count++;
            loadBalancing.push(data);
            $.each(input,function(i,n){
                n.value="";
            });
            select[1].value=0;
            $("#detect-patterns-details").addClass("active").siblings("div").removeClass("active");
            addData("loadBalancing");
        }
    });

    //服务器组配置应用键
    $("#server-group-add .button-group button:first-child").click(function(){
        var mark=true,input=$("#"+$(this).parents(".detect-add ")[0].id+" input:not([type='checkbox'])");
        if(input[0].getAttribute("disabled")==="true"){     //单个编辑的情况下
            input[0].removeAttribute("disabled");
            if(serverGroupAdd.length==0){
                $.each(serverGroup,function(i,n){
                    if(n.service.name===input[0].value){
                        for(var k=i;k<serverGroup.length-1;k++){
                            serverGroup[k]=serverGroup[k+1];
                            serverGroup[k].id--;
                        }
                    }
                });
                serverGroup.pop();
            }else{
                $.each(serverGroup,function(i,n){
                    if(n.id===serverGroupAdd[0].id){
                        $.each(serverGroupAdd[0].service.serviceIP,function(j,m){
                            (n.service.serviceIP.indexOf(m)==-1) && n.service.serviceIP.push(m)
                        });
                        $.each(serverGroupAdd[0].service.note,function(p,q){
                            (n.service.note.indexOf(q)==-1) && n.service.serviceIP.push(q)
                        })
                    }
                });
            }
        }else{                                              //添加的情况下
            $.each(serverGroupAdd,function(i,n){
                $.each(serverGroup,function(j,m){
                    if(m.id == n.id){
                        m.service.serviceIP=m.service.serviceIP.concat(n.service.serviceIP);
                        m.service.note=m.service.note.concat(n.service.note);
                        mark=false;
                    }
                });
                if(mark){
                    serverGroup.push(n);
                }
            });
        }
        serverGroupAdd=[];
        input[0].value="";
        $("#serverGroupAdd tbody").empty();
        $("#detect-patterns-details").addClass("active").siblings("div").removeClass("active");
        addData("serverGroup");
    });

    //服务器组配置页添加项
    $(".add-img").hover(
            function(){
                $(this).siblings("span").show();
            },
            function(){
                $(this).siblings("span").hide();
            }
    )
    .click(function(){
        var input=$("#server-group-add input:not([type='checkbox'])"),inputArr=[],data,id,mark=true,idMark=true,addMark=false,serverGroupAddMark=true,chbs;
        $.each(input,function(i,n){
            if(n.value===""){
                inputArr.push(n);
            }
        });
        if(inputArr.length!=0){
            tipWarning(tipC, tip1, tipP, "请先全部填写要处理的数据信息！");
            mark=false;
        }else{
            $.each(serverGroupAdd,function(i,n){
                if(n.service.serviceIP.indexOf(input[1].value+":"+input[2].value)!=-1 && n.service.name===input[0].value){
                    tipWarning(tipC, tip1, tipP, "所添加数据在新增表中重复！");
                    mark=false;
                }
            });
            $.each(serverGroup,function(i,n){
                if(n.service.serviceIP.indexOf(input[1].value+":"+input[2].value)!=-1 && n.service.name===input[0].value){
                    tipWarning(tipC, tip1, tipP, "所添加数据在原始数据表中重复！");
                    mark=false;
                }
            });
        }
        if(mark){
            //首先判断是否存在于原始数据中
            $.each(serverGroup,function(i,n){
                if(n.service.name===input[0].value){
                    id=i;
                    idMark=false;
                    addMark=true;//存在之后再判断是否在新增数据中
                }
            });
            if(addMark){
                $.each(serverGroupAdd,function(i,n){
                    if(n.id==id){                                                   //如果在新增数据中，直接添加
                        n.service.serviceIP.push(input[1].value+":"+input[2].value);
                        n.service.note.push(input[3].value);
                        serverGroupAddMark=false;                                   //不再压入新的数据\
                    }
                });
            }else{
                $.each(serverGroupAdd,function(i,n){
                    if(n.service.name===input[0].value){                             //如果在新增数据中，直接添加
                        n.service.serviceIP.push(input[1].value+":"+input[2].value);
                        n.service.note.push(input[3].value);
                        serverGroupAddMark=false;                                   //不再压入新的数据
                    }
                });
            }
            if(serverGroupAddMark){
                if(idMark){
                    data={
                        id:length,
                        service:{
                            name:input[0].value,
                            serviceIP:[input[1].value+":"+input[2].value],
                            note:[input[3].value]
                        }
                    };
                    length++;
                    serverGroupAdd.push(data);
                }else{
                    data={
                        id:id,
                        service:{
                            name:input[0].value,
                            serviceIP:[input[1].value+":"+input[2].value],
                            note:[input[3].value]
                        }
                    };
                    serverGroupAdd.push(data);
                }
                $.each(input,function(i,n){
                    (i!=0)&&(n.value="")
                });
            }
            addData("serverGroupAdd");
            chbs=$("#server-group-add tbody [name='checkIP']");
            $.each(chbs,function(i,n){
                n.onclick=selectOne;
            });
        }
    });

    //服务器组配置页删除
    $("#server-group-add .bt-bars li").click(function(){
        var chbs=$("#server-group-add [name='checkIP']"),
            selAll=$("#server-group-add thead input[type=checkbox]"),
            addId=true,
            popMark=false,
            tipMark=true;
        if(selAll[0].checked===true){
            serverGroupAdd=[];
            selAll[0].checked=false;
        }else{
            $.each(chbs,function(i,n){
                var me=$(this);
                if(n.checked==true){
                    $.each(serverGroupAdd,function(k,m){
                        if(m.id==n.getAttribute("data-id")){
                            $.each(m.service.serviceIP,function(p,q){
                                if(q===me.parent()[0].nextSibling.innerHTML+":"+me.parent()[0].nextSibling.nextSibling.innerHTML){
                                    for(var j=p;j<m.service.serviceIP.length-1;j++){
                                        m.service.serviceIP[j]=m.service.serviceIP[j+1];
                                        m.service.note[j]=m.service.note[j+1];
                                    }
                                }
                            });
                            m.service.serviceIP.pop();
                            m.service.note.pop();
                        }
                        if(m.service.serviceIP.length==0){
                            for(var a=k;a<serverGroupAdd.length-1;a++){
                                serverGroupAdd[a]=serverGroupAdd[a+1];
                                $.each(serverGroup,function(b,c){
                                    if(serverGroupAdd[a].id== c.id){
                                        addId=false;
                                    }
                                });
                                addId &&　serverGroupAdd[a].id--;
                            }
                            popMark=true;
                        }
                    });
                    popMark && serverGroupAdd.pop();
                    tipMark=false;
                }
            });
            tipMark && tipWarning(tipC, tip1, tipP, "请选择要删除的选项！");
        }
        tipMark && addData("serverGroupAdd");
    });

    //服务器组单个编辑跳转
    $("#serverGroup").delegate("td[data-id]","click",function(){
        $("#server-group-add").addClass("active").siblings("div").removeClass("active");
        var input=$("#server-group-add input:not([type='checkbox'])"),me=$(this),chbs;
        input[0].setAttribute("disabled","true");
        input[0].value=$(this).html();
        $.each(serverGroup,function(i,n){
            if(n.id==me.attr("data-id")){
                serverGroupAdd.push(n);
            }
        });
        addData("serverGroupAdd");
        chbs=$("#server-group-add tbody [name='checkIP']");
        $.each(chbs,function(i,n){
            n.onclick=selectOne;
        });
    })
</script>